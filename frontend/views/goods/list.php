<?php
use yii\bootstrap\Html;
$this->title = '商品列表';
?>
<?= Html::cssFile('public/frontend/css/base.css'); ?>
<?= Html::cssFile('public/frontend/css/site.css'); ?>

<ol class="breadcrumb">
    <li><a href="#">Home</a></li>
    <li><a href="#">2013</a></li>
    <li class="active">十一月</li>
</ol>
<div class="site-index">

    <div class="body-content" style="background-color: #ffffff; padding: 5px 5px">

        <div class="row" style="margin-bottom: 5px">
            <div class="col-lg-1">
                <button type="button" class="btn btn-primary btn-sm">品牌：</button>
            </div>
            <div class="col-lg-11 attr-list">
                <a class="btn btn-danger btn-sm" href="#" role="button">全部</a>
                <a class="btn btn-default btn-sm" href="#" role="button">鸿星尔克</a>
                <a class="btn btn-default btn-sm" href="#" role="button">李宁</a>
                <a class="btn btn-default btn-sm" href="#" role="button">特步</a>
                <a class="btn btn-default btn-sm" href="#" role="button">海澜之家</a>
                <a class="btn btn-default btn-sm" href="#" role="button">361</a>
            </div>
        </div>
        <div class="row" style="margin-bottom: 5px">
            <div class="col-lg-1">
                <button type="button" class="btn btn-primary btn-sm">品牌：</button>
            </div>
            <div class="col-lg-11 attr-list">
                <a class="btn btn-danger btn-sm" href="#" role="button">全部</a>
                <a class="btn btn-default btn-sm" href="#" role="button">鸿星尔克</a>
                <a class="btn btn-default btn-sm" href="#" role="button">李宁</a>
                <a class="btn btn-default btn-sm" href="#" role="button">特步</a>
                <a class="btn btn-default btn-sm" href="#" role="button">海澜之家</a>
                <a class="btn btn-default btn-sm" href="#" role="button">361</a>
            </div>
        </div>
        <div class="row" style="margin-bottom: 5px">
            <div class="col-lg-1">
                <button type="button" class="btn btn-primary btn-sm">品牌：</button>
            </div>
            <div class="col-lg-11 attr-list">
                <a class="btn btn-danger btn-sm" href="#" role="button">全部</a>
                <a class="btn btn-default btn-sm" href="#" role="button">鸿星尔克</a>
                <a class="btn btn-default btn-sm" href="#" role="button">李宁</a>
                <a class="btn btn-default btn-sm" href="#" role="button">特步</a>
                <a class="btn btn-default btn-sm" href="#" role="button">海澜之家</a>
                <a class="btn btn-default btn-sm" href="#" role="button">361</a>
            </div>
        </div>
        <div class="row" style="margin-bottom: 5px">
            <div class="col-lg-1">
                <button type="button" class="btn btn-primary btn-sm">品牌：</button>
            </div>
            <div class="col-lg-11 attr-list">
                <a class="btn btn-danger btn-sm" href="#" role="button">全部</a>
                <a class="btn btn-default btn-sm" href="#" role="button">鸿星尔克</a>
                <a class="btn btn-default btn-sm" href="#" role="button">李宁</a>
                <a class="btn btn-default btn-sm" href="#" role="button">特步</a>
                <a class="btn btn-default btn-sm" href="#" role="button">海澜之家</a>
                <a class="btn btn-default btn-sm" href="#" role="button">361</a>
            </div>
        </div>
    </div>
    <div class="body-content">
        <div class="row">
            <div class="col-lg-2">
                <div class="row" style="margin: 10px 0px">
                    <div class="">相关推荐</div>
                </div>
                <div class="" style="width: 100%">
                    <div class="thumbnail" style="border: #ffffff">
                        <img src="https://img14.360buyimg.com/n7/jfs/t2686/16/1421960568/180042/72e5cc1/573db86aN1be10b39.jpg"
                             alt="通用的占位符缩略图">
                        <div class="caption">
                            <h3 style="color: #E4393C">¥133.00</h3>
                            <p><a href="#" style="color: #333333"><strong style="color: orange">森马水洗牛仔裤</strong> 2016夏装新款 女士低腰字母背带裤牛仔长裤潮 牛仔中蓝0820 L</a></p>
                        </div>
                    </div>
                </div>
                <div class="" style="width: 100%">
                    <div class="thumbnail" style="border: #ffffff">
                        <img src="https://img14.360buyimg.com/n7/jfs/t2686/16/1421960568/180042/72e5cc1/573db86aN1be10b39.jpg"
                             alt="通用的占位符缩略图">
                        <div class="caption">
                            <h3 style="color: #E4393C">¥133.00</h3>
                            <p><a href="#" style="color: #333333"><strong style="color: orange">森马水洗牛仔裤</strong> 2016夏装新款 女士低腰字母背带裤牛仔长裤潮 牛仔中蓝0820 L</a></p>
                        </div>
                    </div>
                </div>
                <div class="" style="width: 100%">
                    <div class="thumbnail" style="border: #ffffff">
                        <img src="https://img14.360buyimg.com/n7/jfs/t2686/16/1421960568/180042/72e5cc1/573db86aN1be10b39.jpg"
                             alt="通用的占位符缩略图">
                        <div class="caption">
                            <h3 style="color: #E4393C">¥133.00</h3>
                            <p><a href="#" style="color: #333333"><strong style="color: orange">森马水洗牛仔裤</strong> 2016夏装新款 女士低腰字母背带裤牛仔长裤潮 牛仔中蓝0820 L</a></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-10">
                <div class="row" style="width: 100%;margin: 10px 0px;">
                    <div class="col-lg-4">相关商品&nbsp;<strong id="list-total" style="color: orange">?</strong>&nbsp;个</div>
                    <div class="col-lg-8 text-right">排序：
                        <a class="btn btn-danger btn-xs" href="#" role="button">上架时间</a>
                        <a class="btn btn-default btn-xs" href="#" role="button">价格</a>
                        <a class="btn btn-default btn-xs" href="#" role="button">排序时间</a>
                        <a class="btn btn-default btn-xs" href="#" role="button">热度</a>
                    </div>
                </div>
                <div class="row" id="goods-list">
                    <div class="col-sm-6 col-md-3 hide">
                        <div class="thumbnail">
                            <img src="http://img14.360buyimg.com/n7/jfs/t718/254/983764544/122272/4f92a813/55104384N087402f7.jpg"
                                 alt="通用的占位符缩略图">
                            <div class="caption">
                                <h3 style="color: #E4393C">¥133.00</h3>
                                <p><a href="#" style="color: #333333"><strong style="color: orange">森马水洗牛仔裤</strong> 2016夏装新款 女士低腰字母背带裤牛仔长裤潮 牛仔中蓝0820 L</a></p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row" style="float: right">
                    <div class="col-sm-6 col-md-12" id="result-page">
                    <nav>
                        <ul class="pagination">
                            <li><a href="#" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a></li>
                            <li><a href="#">1</a></li>
                            <li><a href="#">2</a></li>
                            <li><a href="#">3</a></li>
                            <li><a href="#">4</a></li>
                            <li><a href="#">5</a></li>
                            <li><a href="#" aria-label="Next"><span aria-hidden="true">&raquo;</span></a></li>
                        </ul>
                        </nav>
                        </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/html" id="productTemplate">
    <div class="col-sm-6 col-md-3">
        <div class="thumbnail">
            <img src="<%=ad_img%>" alt="通用的占位符缩略图" style="height: 220px">
            <div class="caption" style="height: 130px">
                <h3 style="color: #E4393C">¥<%=sell_price%> <small><del>¥<%=market_price%></del></small></h3>
                <p><a href="<?= Yii::$app->urlManager->createUrl(['goods/detail'])?>&id=<%=id%>" style="color: #333333"><%=name%></a></p>
            </div>
        </div>
    </div>
</script>

<?= Html::jsFile('public/common/js/upload-page.js'); ?>
<?= Html::jsFile('public/common/js/template.js'); ?>

<?php $this->beginBlock('jquery') ?>

    $(function() {

        var reajax = null;
        var page = null;
        function getResourcesHandle(pa) {
            var $list = $("#goods-list");
            var val = $("#searchForm_keyWord").val();
            var key_Word = val;
            if (key_Word == "" || key_Word == "请输入关键字") {
                key_Word = "";
            }
            var len = pa.len;                   // 获取分页长度
            var cur = pa.start;                 // 获取第几页
            var data = getConditions();         // 获取大部分搜索条件
            data.page = cur;
            data.pageSize = len;
            data.keyWord = key_Word;    // 获取关键字
            $list.html('<div class="col-sm-12 col-md-12"><article style="width:400px;margin: 150px auto;"><img src="public/common/images/loading.gif"><span style="font-size: 24px;margin-left: 20px;">正在加载信息，请稍候...</span></article></div>');
            reajax && reajax.abort();           //取消上一个同等请求
            reajax = $.ajax({
                url: "<?= Yii::$app->urlManager->createUrl(['goods/ajax-list']);?>",
                type: "GET",
                dataType: "json",
                data: data,
                success: function(data) {
                    var list = data.data && data.data.list ? data.data.list : [];
                    // 设置分页
                    pa.page.setPage(data.data ? data.data.total || 0 : 0);
                    $("#list-total").text(data.data ? data.data.total || 0 : 0);
                    // 设置资源
                    var items = "";
                    for (var i = 0, leni = list.length; i < leni; i++) {
                        items += template.render("productTemplate", list[i]);
                    }
                    if (leni == 0) {
                        items = '<p class="text-center" style="font-size:24px;color:orange;height:300px;line-height:300px;">暂无内容！</p>';
                    }
                    $list.html(items);
                },
                error: function() {
                    reajax.statusText != "abort" && $list.html('<p class="f24 orange font-y tc" style="height:300px;line-height:300px;">暂无内容！</p>');
                }
            });
        }

        // 分页
        function getPage(params) {
            page = null;
            page = new UpLoadPage({
                len: 48,
                $el: $("#result-page"),
                callback: getResourcesHandle,
                params: params
            });
            page.init();
        }

        //搜索条件
        function getConditions()
        {
            return {};
        }

        getPage();
    });

<?php $this->endBlock() ?>
<?php $this->registerJs($this->blocks['jquery'], \yii\web\View::POS_END); ?>



